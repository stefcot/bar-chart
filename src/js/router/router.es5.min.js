!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Router=t()}(this,function(){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},t=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},n=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),s=function(e){try{return JSON.stringify(e)}catch(t){return console.warn("[local-router] ERROR: failed to stringify JSON data.",t,e),""}},i=function(e){try{return JSON.parse(e)}catch(t){return console.warn("[local-router] ERROR: failed to parse JSON data.",t,e),null}},o=function(e){return"string"==typeof e?document.getElementById(e)||document.querySelector(e):e},a=function(t){var n={};return Object.keys(t).forEach(function(o){var a=t[o];a===!0?n[o]={encode:s,decode:i}:"object"===("undefined"==typeof a?"undefined":e(a))?(n[o]=a,a.encode||(a.encode=s),a.decode||(a.decode=i)):n[o]=!1}),n},r=function(){function e(){var n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],s=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=s.index,r=void 0===i?"index":i,c=s.invalid,h=void 0===c?r:c,u=s.prefix,l=void 0===u?"page-":u,f=s.elem,d=void 0===f?document.body:f,m=s.separator,v=void 0===m?"-":m;t(this,e),this.$elem=o(d),this.prefix=l,this.separator=v,this.index=r,this.invalid=h,this.routes=a(n),this.names=Object.keys(n),this.callbacks={"*":[]},this.hashes={},this.current=null,this.init()}return n(e,[{key:"init",value:function(){var e=this;console.log("router"),this.genChecks(),this.names.forEach(function(t){e.callbacks[t]=[],e.hashes[t]=new RegExp("^#"+e.getHash(t)+"$","i")}),window.addEventListener("hashchange",this),window.addEventListener("load",this)}},{key:"genChecks",value:function(){this.rnames=new RegExp("^("+this.names.join("|")+")$","i"),this.rhashes=new RegExp("^#("+this.names.map(this.getHash,this).join("|")+")$","i"),this.rcallbacks=new RegExp("^("+this.names.join("|")+"|\\*)$")}},{key:"getHash",value:function(e){return this.routes[e]?e+this.separator+".*":e}},{key:"addRoute",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];return this.rnames.test(e)||(this.routes[e]=t.encode&&t.decode?t:!1,this.names.push(e),this.callbacks[e]=[],this.hashes[e]=new RegExp("^#"+this.getHash(t)+"$","i"),this.genChecks()),this}},{key:"removeRoute",value:function(e){return this.rnames.test(e)&&(this.routes[e]=void 0,this.names.splice(this.names.indexOf(e),1),this.callbacks[e]=void 0,this.hashes[e]=void 0,this.genChecks()),this}},{key:"handleEvent",value:function(){var e=this,t=location.hash;this.rhashes.test(t)?!function(){var n=t.indexOf(e.separator),s=t.slice(1,-1===n?t.length:n),i=!!e.routes[s],o=void 0;if(i){var a=t.slice(n+1);o=e.routes[s].decode(a||"")}console.log(s),e.current&&e.$elem.classList.remove(e.prefix+e.current),e.current=s,e.$elem.classList.add(e.prefix+s),e.callbacks[s].forEach(function(n){n(o,t,e)}),e.callbacks["*"].forEach(function(n){n(s,o,t,e)})}():this.invalid&&(location.hash="#"+this.invalid)}},{key:"on",value:function(e,t){return this.rcallbacks.test(e)&&this.callbacks[e].push(t),this}},{key:"off",value:function(e,t){if(this.rcallbacks.test(e)){var n=this.callbacks[e].indexOf(t);-1!==n&&this.callbacks[e].splice(n,1)}return this}},{key:"go",value:function(e,t){if(this.rnames.test(e)){this.routes[e]&&(e+=this.separator+encodeURIComponent(this.routes[e].encode(t)));var n="#"+e;location.hash!==n&&(location.hash=n)}return this}}]),e}();return r});